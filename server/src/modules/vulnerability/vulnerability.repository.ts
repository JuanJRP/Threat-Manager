import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// Crear vulnerabilidad
export const createVulnerability = async (data: any) => {
    return prisma.vulnerability.create({
        data,
    });
};

// Importar varias vulnerabilidades
export const importVulnerabilities = async (data: any[]) => {
    return prisma.vulnerability.createMany({
        data,
    });
};

// Consultar vulnerabilidades y sus controles asociados
export const getVulnerabilities = async () => {
    return prisma.vulnerability.findMany({
        include: {
            code: true,
        },
    });
};

// Modificar vulnerabilidad
export const updateVulnerability = async (id: number, data: any) => {
    return prisma.vulnerability.update({
        where: { id },
        data,
    });
};

// Eliminar vulnerabilidad
export const deleteVulnerability = async (id: number) => {
    return prisma.vulnerability.delete({
        where: { id },
    });
};

// Eliminar varias vulnerabilidades
export const deleteVulnerabilities = async (ids: number[]) => {
    return prisma.vulnerability.deleteMany({
        where: {
            id: {
                in: ids,
            },
        },
    });
};
